<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>블라인드 합의 제안 - SafeSettlement</title>
    <link rel="stylesheet" href="style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <a href="index.html" class="logo">SafeSettlement.</a>
            <nav class="nav-links">
                <div class="nav-item active" onclick="location.href='dashboard.html'">
                    <i class="fas fa-chart-pie"></i>
                    <span>사건 현황 (블라인드)</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-comments"></i>
                    <span>안심 채팅</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-file-signature"></i>
                    <span>합의서 관리</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-gavel"></i>
                    <span>변호사 중재</span>
                </div>
                <div style="flex: 1;"></div>
                <div class="nav-item">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>로그아웃</span>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="top-bar">
                <div>
                    <h2 style="margin-bottom: 5px;">블라인드 합의 제안</h2>
                    <p style="color: var(--text-muted);">감정 소모 없이 희망 금액을 조율해보세요.</p>
                </div>
                <div style="display: flex; gap: 15px; align-items: center;">
                    <button class="btn btn-glass" style="font-size: 0.85rem;" onclick="location.href='dashboard.html'">
                        <i class="fas fa-arrow-left" style="margin-right: 6px;"></i> 뒤로가기
                    </button>
                    <span class="status-badge" id="statusBadge"
                        style="background: var(--bg-card); color: var(--text-muted);">제안 대기중</span>
                </div>
            </div>

            <!-- Blind Proposal Section -->
            <div class="dashboard-grid" style="grid-template-columns: 1fr 1fr;">

                <!-- Left: My Proposal -->
                <div class="glass-card" style="height: 100%;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h3>나의 희망 금액</h3>
                        <span
                            style="font-size: 0.8rem; padding: 4px 10px; background: rgba(255,255,255,0.1); border-radius: 12px;">비공개
                            안전 보장 <i class="fas fa-lock s"></i></span>
                    </div>

                    <div style="text-align: center; margin-bottom: 40px;">
                        <p style="color: var(--text-muted); margin-bottom: 10px;">상대방에게 구체적인 금액이 노출되지 않습니다.</p>
                        <div style="position: relative; max-width: 300px; margin: 0 auto;">
                            <span
                                style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); font-size: 1.2rem; color: var(--text-muted);">₩</span>
                            <input type="number" id="myAmount" class="form-input"
                                style="padding-left: 40px; font-size: 1.5rem; font-weight: bold; text-align: center;"
                                placeholder="0">
                        </div>
                    </div>

                    <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 15px;"><i class="fas fa-balance-scale"></i> AI 분석 가이드</h4>
                        <ul
                            style="font-size: 0.9rem; color: var(--text-muted); text-align: left; list-style: disc; padding-left: 20px;">
                            <li>유사 판례 평균: <strong>350만원 ~ 400만원</strong></li>
                            <li>너무 낮은 금액은 상대방의 거부감을 유발할 수 있습니다.</li>
                        </ul>
                    </div>

                    <button class="btn btn-primary" style="width: 100%;" onclick="submitProposal()">제안 등록하기</button>
                </div>

                <!-- Right: Gap Analysis Result -->
                <div class="glass-card"
                    style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">

                    <div id="waitingState">
                        <div style="font-size: 4rem; color: var(--text-muted); margin-bottom: 20px; opacity: 0.3;">
                            <i class="fas fa-user-secret"></i>
                        </div>
                        <h3>상대방의 제안을 기다리고 있습니다</h3>
                        <p style="color: var(--text-muted); margin-top: 10px;">양측 모두 제안을 등록하면<br>금액 차이(Gap) 범위만 알려드립니다.
                        </p>
                    </div>

                    <div id="resultState" style="display: none; width: 100%;">
                        <div style="margin-bottom: 30px;">
                            <span style="font-size: 0.9rem; color: var(--secondary);">분석 완료</span>
                            <h2 style="font-size: 2rem; margin-top: 10px;" id="gapTitle">금액 차이가 큽니다</h2>
                        </div>

                        <!-- Gauge Visual -->
                        <div
                            style="width: 100%; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 30px; position: relative;">
                            <div id="gapGauge"
                                style="width: 80%; height: 100%; background: linear-gradient(90deg, #ff4d4d, #f9cb28); border-radius: 10px; transition: width 1s ease;">
                            </div>

                            <!-- Markers -->
                            <div style="position: absolute; left: 20%; top: 25px; font-size: 0.7rem; color: #aaa;">|
                                100만 이내</div>
                            <div style="position: absolute; left: 50%; top: 25px; font-size: 0.7rem; color: #aaa;">|
                                500만 이내</div>
                            <div style="position: absolute; left: 80%; top: 25px; font-size: 0.7rem; color: #aaa;">|
                                1000만 이상</div>
                        </div>

                        <p style="color: var(--text-muted); line-height: 1.6; margin-bottom: 30px;" id="gapDesc">
                            양측의 의견 차이가 <strong>500만원 ~ 1000만원</strong> 사이입니다.<br>
                            직접적인 대화보다는 전문가의 중재를 고려해보시는 것이 좋습니다.
                        </p>

                        <div id="actionButtons">
                            <button class="btn btn-glass" style="margin-right: 10px;">금액 수정 제안</button>
                            <button class="btn btn-primary"
                                style="background: linear-gradient(135deg, #FF6B6B, #FF8E53);">변호사 중재 신청</button>
                        </div>
                    </div>

                </div>

            </div>
        </main>
    </div>

    <script>
        // Mock function to simulate Blind Gap Logic
        function submitProposal() {
            const myAmount = parseInt(document.getElementById('myAmount').value);
            if (!myAmount) return alert('희망 금액을 입력해주세요.');

            const btn = document.querySelector('.btn-primary');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 분석중...';
            btn.disabled = true;

            // Simulate Server Delay and Victim's Hidden Amount (e.g., 500 Man-won)
            setTimeout(() => {
                const victimAmount = 8000000; // Victim wants 800
                const diff = Math.abs(victimAmount - myAmount);

                document.getElementById('waitingState').style.display = 'none';
                document.getElementById('resultState').style.display = 'block';

                const gapTitle = document.getElementById('gapTitle');
                const gapDesc = document.getElementById('gapDesc');
                const gapGauge = document.getElementById('gapGauge');
                const statusBadge = document.getElementById('statusBadge');
                const actionButtons = document.getElementById('actionButtons');

                if (diff <= 1000000) {
                    // <= 100 gap
                    gapTitle.textContent = "합의점에 거의 도달했습니다!";
                    gapDesc.innerHTML = "양측의 의견 차이가 <strong>100만원 이내</strong>입니다.<br>조금만 더 서로 양보하면 원만한 합의가 가능합니다.";
                    gapGauge.style.width = '10%';
                    gapGauge.style.background = 'var(--secondary)';
                    statusBadge.textContent = '합의 임박';
                    statusBadge.style.color = 'var(--secondary)';
                    actionButtons.innerHTML = '<button class="btn btn-primary">최종 금액 제안하기</button>';
                } else if (diff <= 5000000) {
                    // <= 500 gap
                    gapTitle.textContent = "의견 차이가 조금 있습니다";
                    gapDesc.innerHTML = "양측의 의견 차이가 <strong>100만원 ~ 500만원</strong> 사이입니다.<br>안심 채팅을 통해 정중하게 사정을 설명해보세요.";
                    gapGauge.style.width = '30%';
                    gapGauge.style.background = 'var(--primary)'; // Blue
                    statusBadge.textContent = '조율 필요';
                } else if (diff <= 10000000) {
                    // <= 1000 gap
                    gapTitle.textContent = "시각 차이가 꽤 큽니다";
                    gapDesc.innerHTML = "양측의 의견 차이가 <strong>500만원 ~ 1,000만원</strong> 사이입니다.<br>감정적 대응을 자제하고 냉각기를 가지거나 중재를 요청하세요.";
                    gapGauge.style.width = '50%';
                    gapGauge.style.background = '#f9cb28'; // Yellow
                    statusBadge.textContent = '중재 권장';
                } else if (diff <= 30000000) {
                    // <= 3000 gap
                    gapTitle.textContent = "상당한 입장 차이가 있습니다";
                    gapDesc.innerHTML = "양측의 의견 차이가 <strong>1,000만원 ~ 3,000만원</strong> 사이입니다.<br>개인 간 해결이 어려울 수 있습니다. 변호사 상담을 강력히 권장합니다.";
                    gapGauge.style.width = '70%';
                    gapGauge.style.background = '#ff8e53'; // Orange
                    statusBadge.textContent = '전문가 필수';
                    statusBadge.style.color = '#ff8e53';
                } else if (diff <= 50000000) {
                    // <= 5000 gap
                    gapTitle.textContent = "매우 심각한 입장 차이입니다";
                    gapDesc.innerHTML = "양측의 의견 차이가 <strong>3,000만원 ~ 5,000만원</strong> 사이입니다.<br>법적 분쟁으로 비화될 가능성이 높습니다.";
                    gapGauge.style.width = '90%';
                    gapGauge.style.background = '#ff4d4d'; // Red
                    statusBadge.textContent = '분쟁 위험';
                    statusBadge.style.color = '#ff4d4d';
                } else {
                    // > 5000 gap
                    gapTitle.textContent = "합의가 불가능해 보입니다";
                    gapDesc.innerHTML = "양측의 의견 차이가 <strong>5,000만원 이상</strong>입니다.<br>사실상 합의 결렬 상태입니다. 재판 준비를 하시는 것이 좋습니다.";
                    gapGauge.style.width = '100%';
                    gapGauge.style.background = '#800000'; // Dark Red
                    statusBadge.textContent = '결렬 위기';
                    statusBadge.style.color = '#800000';
                }

                btn.innerHTML = '수정 제안하기';
                btn.disabled = false;
                btn.classList.add('btn-glass');
                btn.classList.remove('btn-primary');
            }, 1000);
        }
    </script>
</body>

</html>